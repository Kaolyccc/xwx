{% extends 'mymessages/base.html' %}

{% block content %}
    <div class="mb-3">
        <h3>{{ message.title }}</h3>
        <p class="text-muted">{{ message.created_at|date:"Y-m-d H:i" }}</p>
        <p>{{ message.content }}</p>
    </div>

    <!-- é¡¯ç¤ºæ–‡ç« æ¨™é¡Œå’Œå…§å®¹ -->
    <p>ä½œè€…: {{ message.user.nickname|default:message.user.username }}</p>

    <!-- ç•™è¨€å€ -->
    <h3>ğŸ’¬ ç•™è¨€å€</h3>
    <div class="card">
        <div class="card-header">ç•™è¨€</div>
        <div class="card-body">
            {% for comment in message.comments.all %}
                <div class="border-bottom pb-3 mb-3">
                    <p>{{ comment.content }}</p>
                    <small class="text-muted">{{ comment.user.username }} - æ’°å¯«æ™‚é–“: {{ comment.created_at|date:"Y-m-d H:i" }}</small>
                </div>
            {% empty %}
                <p class="text-center text-muted">å°šç„¡ç•™è¨€</p>
            {% endfor %}
        </div>
    </div>

    <!-- æäº¤ç•™è¨€è¡¨å–® -->
    {% if user.is_authenticated %}
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">æäº¤ç•™è¨€</button>
        </form>
    {% else %}
        <p>è«‹ <a href="{% url 'login' %}">ç™»å…¥</a> å¾Œæ‰èƒ½ç•™è¨€ã€‚</p>
    {% endif %}

{% endblock %}
